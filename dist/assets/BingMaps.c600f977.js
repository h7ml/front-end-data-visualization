import{Z as t,af as e,ag as i,ah as r,A as o}from"./ol.fd4c2e5b.js";import{e as a,c as n,b as s,d as u,a as c}from"./TileImage.e8088637.js";import{j as m}from"./net.7b649b59.js";var h,p=(h=function(t,e){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});var l=function(c){function h(i){var r=this,o=void 0!==i.hidpi&&i.hidpi;(r=c.call(this,{cacheSize:i.cacheSize,crossOrigin:"anonymous",imageSmoothing:i.imageSmoothing,opaque:!0,projection:t("EPSG:3857"),reprojectionErrorThreshold:i.reprojectionErrorThreshold,state:e.LOADING,tileLoadFunction:i.tileLoadFunction,tilePixelRatio:o?2:1,wrapX:void 0===i.wrapX||i.wrapX,transition:i.transition,zDirection:i.zDirection})||this).hidpi_=o,r.culture_=void 0!==i.culture?i.culture:"en-us",r.maxZoom_=void 0!==i.maxZoom?i.maxZoom:-1,r.apiKey_=i.key,r.imagerySet_=i.imagerySet;var a="https://dev.virtualearth.net/REST/v1/Imagery/Metadata/"+r.imagerySet_+"?uriScheme=https&include=ImageryProviders&key="+r.apiKey_+"&c="+r.culture_;return m(a,r.handleImageryMetadataResponse.bind(r),void 0,"jsonp"),r}return p(h,c),h.prototype.getApiKey=function(){return this.apiKey_},h.prototype.getImagerySet=function(){return this.imagerySet_},h.prototype.handleImageryMetadataResponse=function(c){if(200==c.statusCode&&"OK"==c.statusDescription&&"ValidCredentials"==c.authenticationResultCode&&1==c.resourceSets.length&&1==c.resourceSets[0].resources.length){var m=c.resourceSets[0].resources[0],h=-1==this.maxZoom_?m.zoomMax:this.maxZoom_,p=this.getProjection(),l=a(p),d=this.hidpi_?2:1,g=m.imageWidth==m.imageHeight?m.imageWidth/d:[m.imageWidth/d,m.imageHeight/d],f=n({extent:l,minZoom:m.zoomMin,maxZoom:h,tileSize:g});this.tileGrid=f;var y=this.culture_,v=this.hidpi_;if(this.tileUrlFunction=s(m.imageUrlSubdomains.map((function(t){var e=[0,0,0],i=m.imageUrl.replace("{subdomain}",t).replace("{culture}",y);return function(t,r,o){if(t){u(t[0],t[1],t[2],e);var a=i;return v&&(a+="&dpi=d1&device=mobile"),a.replace("{quadkey}",function(t){var e,i,r=t[0],o=new Array(r),a=1<<r-1;for(e=0;e<r;++e)i=48,t[1]&a&&(i+=1),t[2]&a&&(i+=2),o[e]=String.fromCharCode(i),a>>=1;return o.join("")}(e))}}}))),m.imageryProviders){var _=i(t("EPSG:4326"),this.getProjection());this.setAttributions(function(t){var e=[],i=t.viewState,a=this.getTileGrid(),n=a.getZForResolution(i.resolution,this.zDirection),s=a.getTileCoordForCoordAndZ(i.center,n)[0];return m.imageryProviders.map((function(i){for(var a=!1,n=i.coverageAreas,u=0,c=n.length;u<c;++u){var m=n[u];if(s>=m.zoomMin&&s<=m.zoomMax){var h=m.bbox,p=[h[1],h[0],h[3],h[2]],l=r(p,_);if(o(l,t.extent)){a=!0;break}}}a&&e.push(i.attribution)})),e.push('<a class="ol-attribution-bing-tos" href="https://www.microsoft.com/maps/product/terms.html" target="_blank">Terms of Use</a>'),e}.bind(this))}this.setState(e.READY)}else this.setState(e.ERROR)},h}(c);export{l as B};
